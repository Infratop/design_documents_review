# ER図1_レビュー
## 全体
- Railsで自動で作成されるカラム(id, created_at, updated_at)を考慮してない。
  > "ActiveRecordでデフォルトで作られる登録日、更新日の記述もお願いいたします。
  > もし持たないのであれば理由を教えてください。"
- 受注明細がない。
- 入荷管理用のテーブルがない。
  > 要件に「入荷履歴を表示できること（入荷した日時、入荷した商品、個数）」がありますが、どのように実現しますか。

## 管理者
- エンドユーザテーブルとのリレーションがある。
- 商品テーブルとのリレーションがある。
  > 管理者テーブルとエンドユーザーテーブル、商品テーブルにリレーションがありますが、理由はありますか。

## エンドユーザ
- 論理削除を考慮してない。
  > エンドユーザが退会した場合、該当のレコードはどうなりますか。

## 商品
- アーティスト名カラムがある。(表記ゆれ防止、updateの手間を省くため)
- ジャンルカラムがある。(表記ゆれ防止、updateの手間を省くため)
- レーベルカラムがある。(表記ゆれ防止、updateの手間を省くため)
  > アーティスト名、レーベル名、ジャンル等は画面でベタ打ちですか？
  > 表記揺れが起こらないような設計にできるとbetterです。
- 曲名カラムがある。
  > 曲カラムがありますが、同一カラムに複数の曲名を入れるということでしょうか？
  > * 1曲だけ曲名を変更したい・1曲だけ削除したい、など、後からデータを変更する際に不便になります。
  > * 複数ディスク、曲順などの管理も難しくなります。
  > * ユーザー側に表示するときにデザインも当てづらくなります。
  > * カリキュラム「チーム開発の手引き」＞「設計」＞データベース設計スライドの29枚目以降を再確認してください。
- 複数枚ディスクを考慮してない。
  > 複数枚組のCDは登録できますか。
- 論理削除を考慮してない。
  > 商品を削除した場合、該当のレコードはどうなりますか。
- ステータスが何を意味しているか不明。
  > ステータス(取り扱い)は、具体的に何の取り扱いのステータスになりますか。
  > 具体的に命名してください。
- 在庫数カラムがある。（在庫数は入荷と売上から算出する）
  > "在庫数カラムがありますが、商品が入荷するたびに数値を変更するのでしょうか。
  > * 例えば現在の在庫が100個あって、入荷が350個あった場合、在庫数を450と入力する運用だとすると計算ミスを誘発しやすく、実際の在庫数とデータベース上の在庫数に差が生まれやすい構造となります。
  > * 入荷したタイミングで入荷数を入れられるようにすれば楽です。
  > * 運営上、「いつ、どの商品が入荷したか」という情報を管理しておく方が安全な運用です。
  > * 入荷数の証拠にもなります。

## カート
- テーブル名が実際の役割と異なる(= カート内商品のはず)
  > カートテーブルという命名ですが、表現されているのは「カートの中身」かと思います。
  > カートは一つ、その中に入っている商品は複数、というイメージかと思いますので、テーブル名を「カートアイテム」「カート内商品」のような命名にすると良いかと思います。
- 合計金額をもっている(= 算出できる)
  > カートテーブルの1レコードは商品1つに対してのレコードになります。商品ごとに合計金額のデータを保持する理由はありますでしょうか？
- PKの命名がテーブル名とあっていない。
  > PKが注文idになっています。
- カラムとして必要のないカラムがある。(アーティスト名、ジャケット画像、シングル/アルバム名)
  > アーティスト名、ジャケット画像、シングル/アルバム名のカラムが存在しますが、商品idをFKとて持ち、商品テーブルからデータを引用できることから、これらのカラムは不要です。
- エンドユーザと直接リレーションがない。
  > カート内の商品は顧客ごとに異なりますが、どのように判断しますか
- 商品に対してカートが1以上のカーディナリティになっている
  > 商品に対してカートが1以上のカーディナリティになっていますが、商品を登録したとき、カートも存在しないといけないでしょうか。

## 購入
- 管理者視点のテーブル名になっていない。
  > テーブル名は、管理者視点の用語にしましょう。`購入`ではなく`注文`や`受注`などが適切です。
- 購入日カラムを持っている。
  > 購入日カラムがありますが、ActiveRecordでデフォルトで作られる「登録日」で代用可能かと思います。登録日をカラムに追加した上で、別カラムとして購入日カラムを設ける場合、理由をお知らせください。
- 送料カラムがない。
  > 送料はどこで確認しますか。
- 合計金額カラムがない。
  > 合計金額はどこで確認できますか。
- 送付先住所カラムがあるが、宛名と郵便番号がない。
  > 住所カラムに郵便番号、住所、氏名を全て詰め込むのでしょうか。
- 商品idと注文個数をもっている
  > 商品idと注文個数を持っていますが、複数商品を複数個で注文できるはずなので、同一カラムに配列で商品idや注文個数を格納することになります。
  > 配列でデータを格納するとデータの操作が煩雑になり面倒です。
  > 配列になるカラムは別テーブルとして分離しましょう。
- 注文時の価格を保持するカラムがない
  > 注文時の価格はどのように参照しますか。

# 注意
* マークダウン形式で記入してください。
* 全体を通しての指摘事項の場合、テーブル名の部分を「全体」「共通」などとしてください。

